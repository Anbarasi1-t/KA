<app-menubar
  [annualContribution]="userProfile?.annualContribution ?? 0"
  (searchChange)="onSearchChange($event)"
  (filterToggle)="onFilterToggle()">
</app-menubar>

<div class="dashboard-content">
  <div class="left-section" #leftCol>
    <app-user-profile></app-user-profile>
  </div>

  <div class="right-section" #rightCol>
    <div class="right-scroll">

      <!-- Show empty state if annualContribution is 0 -->
      <ng-container *ngIf="userProfile?.annualContribution === 0; else normalView">
        <app-no-contribution></app-no-contribution>
      </ng-container>

      <!-- Otherwise show the regular dashboard -->
      <ng-template #normalView>
        <div class="tab-filter-row">
          <app-tab-switcher
            [selectedTab]="selectedTab"
            style="margin-bottom: 0;"
            (tabChange)="onTabChange($event)">
          </app-tab-switcher>

          <button
            *ngIf="selectedTab === 'contribution'"
            class="icon-button filter-button"
            type="button"
            (click)="onFilterToggle()"
            aria-label="Toggle filters"
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="#7D838B">
              <path d="M3 5h18v2H3V5zm4 6h10v2H7v-2zm3 6h4v2h-4v-2z"/>
              <line
                *ngIf="filterActive"
                class="filter-cross"
                x1="5" y1="5" x2="17" y2="17"
                stroke-width="2"
              />
            </svg>
          </button>
        </div>

        <ng-container *ngIf="selectedTab === 'contribution'; else referralsView">
          <app-contribution-filter
            *ngIf="showFilters"
            (filtersChange)="onContributionFiltersChange($event)"
            style="margin: 0 0 6px 0;">
          </app-contribution-filter>

          <app-contribution-table
            [rows]="contributionRows"
            [filters]="contributionFilters">
          </app-contribution-table>
        </ng-container>

        <ng-template #referralsView>
          <app-summary-cons class="summarycons"></app-summary-cons>
          <div class="table-container">
            <app-referral-table
              class="referraltable"
              style="width: 100%;"
              [searchTerm]="searchTerm">
            </app-referral-table>
          </div>
        </ng-template>
      </ng-template>
    </div>
  </div>
</div>
